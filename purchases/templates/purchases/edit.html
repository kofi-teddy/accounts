{% extends 'accountancy/edit.html' %}

{% load static %}
{% load crispy_forms_tags %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'purchases/css/purchase_input.css' %}">
{% endblock extra_head %}

{% block matching %}
<div class="my-4">
    <div class="mb-2">
        <h2 class="h6 font-weight-bold">Existing Matching</h2>
        <small class="form-text text-muted">These transactions are already matched</small>
    </div>
    <div>
        <div class="d-none matching_transactions_formset">
            {{ matching_formset.management_form|crispy }}
        </div>
        <div class="matched_transactions_wrapper">
            <table class="existing_matched_transactions">
                {% crispy matching_formset %}
            </table>
        </div>
    </div>
</div>
<div class="my-4">
    <div class="mb-2">
        <h2 class="h6 font-weight-bold">New Matching Transactions</h2>
        <small class="form-text text-muted">These transactions you've matched have not yet been saved</small>
    </div>
    <div>
        <table class="new_matched_transactions">
            <thead>
                <tr>
                    <th>
                        Type
                    </th>
                    <th>
                        Ref
                    </th>
                    <th>
                        Total
                    </th>
                    <th>
                        Paid
                    </th>
                    <th>
                        Due
                    </th>
                    <th>
                        Matched by
                    </th>
                    <th>
                        Matched to
                    </th>
                    <th>
                        Value
                    </th>
                    <th>
                        Id
                    </th>
                </tr>
            </thead>
            <tbody class="table-bordered">
                {% crispy matching_formset.empty_form matching_formset.empty_form.helpers.empty_form %}
            </tbody>
        </table>     
    </div>
</div>
{% endblock matching %}

{% block under_form %}
    {% include 'accountancy/outstanding.html' %}
{% endblock under_form %}

{% block modal_forms %}
    {% include 'accountancy/on_the_fly.html' %}
{% endblock modal_forms %}

{% block extra_js %}
    {% include 'accountancy/grid_js.html' with header_form=header_form %}
    {% include 'accountancy/edit_matching_js.html' %}
    <script src="{% static 'purchases/js/on_the_fly.js' %}"></script>
    <script>
        {% include 'purchases/type_dependent_layout.js' with header_form_prefix=header_form_prefix %}
    </script>
{% endblock extra_js %}